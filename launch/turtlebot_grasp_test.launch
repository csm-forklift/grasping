<!-- Simulate forklift using turtlebot to test approach control -->
<launch>
    <arg name="debug" default="false"/>

    <!-- Start up the joystick -->
    <arg name="joy_config" default="logitech" />
    <arg name="joy_dev" default="/dev/input/js0" />
    <arg name="config_filepath" default="$(find teleop_twist_joy)/config/$(arg joy_config).config.yaml" />

    <node pkg="joy" type="joy_node" name="joy_node">
        <param name="dev" value="$(arg joy_dev)" />
        <param name="deadzone" value="0.3" />
        <param name="autorepeat_rate" value="20" />
    </node>

    <!-- Begin turtlebot -->
    <include file="$(find turtlebot_bringup)/launch/minimal.launch"/>

    <!-- Start up the lidar -->
    <include file="$(find ouster_ros)/launch/lidar2.launch"/>

    <!-- Start the cylinder detection -->
    <node pkg="grasping" name="cylinder_detection" type="cylinder_detection">
        <param name="debug" value="$(arg debug)"/>
        <param name="target_frame" value="odom"/>
        <param name="target_x" value="0.0"/>
        <param name="target_y" value="1.0"/>
    </node>

    <!-- Run approach controller -->

    <!-- Convert velocity and angle setpoints into a Twist command -->
    <node pkg="sensors" name="velocity_conversion" type="velocity_conversion">
        <param name="use_covariance" value="false"/>
        <remap from="/velocity_node/velocity" to="dylons_velocity"/>
        <remap from="/steering_node/filtered_angle" to="dylons_angle"/>
    </node>
</launch>
